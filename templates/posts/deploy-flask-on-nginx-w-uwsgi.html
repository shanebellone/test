{% extends "base.html" %}
{% block title %}Deploy Flask on Debian 10 with Nginx and uWSGI{% endblock %}

{% block content %}
    <h1>Deploy Flask on Debian 10 with Nginx and uWSGI.</h1>
    <sub>Required: Updated Debian 10 server with root privileges and a domain name.</sub>
    <br>
    <h3>1.) Install Nginx</h3>
    <code>apt install nginx</code>
    <p>Verify Nginx is running by navigating to the server's IP address.</p>
    <br>
    <h3>2.) Install Flask & uWSGI</h3>
    <code>apt install python3-pip python-dev</code>
    <code>pip3 install uwsgi flask</code>
    <br>
    <h3>3.) Create Web Directory</h3>
    <code>mkdir /var/www/&#91;project_name]</code>
    <h3>4.) Create Simple App</h3>
    <code>nano /var/www/&#91;project_name]/main.py</code>
    <p>Add the following:</p>
    <code>from flask import Flask<br>app = Flask(__name__)<br><br>@app.route(\"/\")<br>def index():<br> return \"Hello
        World!\"<br><br>if __name__ == \"__main__\":<br> app.run(host=\"0.0.0.0\")<br>ï»¿</code>
    <br>
    <h3>5.) Create config-uwsgi.ini</h3>
    <code>nano /var/www/&#91;project_name]/config-uwsgi.ini</code>
    <p><strong>Add the following:</strong></p>
    <code>&#91;uwsgi]<br><br>app = main<br>module = %(app)<br>callable = app<br><br>socket = /var/www/&#91;project_name]/&#91;project_name].sock<br>chdir
        = /var/www/&#91;project_name]<br>chmod-socket = 666<br><br>processes = 4<br>die-on-term = true</code>
    <br>
    <h3>6.) Setup Nginx</h3>
    <p><strong>Remove default configuration</strong></p>
    <code>rm /etc/nginx/sites-enabled/default</code>
    <p><strong>Create new configuration</strong></p>
    <code>nano /var/www/&#91;project_name]/config-nginx.conf</code>
    <p><strong>Add the following:</strong></p>
    <code>server {<br> listen 80;<br> listen &#91;::]:80;<br><br> server_name &#91;your_domain].com www.&#91;your_domain].com;<br><br>
        location / {<br> include uwsgi_params;<br> uwsgi_pass
        unix:/var/www/&#91;project_name]/&#91;project_name].sock;<br>
        }<br>}</code>
    <p><strong>Create symbolic link from Nginx directory to conf.d directory</strong></p>
    <code>ln -s /var/www/&#91;project_name]/config-nginx.conf /etc/nginx/conf.d/</code>
    <p><strong>Restart Nginx</strong></p>
    <code>systemctl restart nginx</code>
    <br>
    <h3>7.) Run uWSGI</h3>
    <p><strong>Start service</strong></p>
    <code>nohup uwsgi /var/www/&#91;project_name]/config-uwsgi.ini &amp;</code>
    <p><strong>Notes:</strong><em>CTRL + C to hide the process. Run uWSGI under systemd for live project.</em></p>
    <br>
    <h3>8.) Let's Encrypt SSL Certificate</h3>
    <p><strong>Install Certbot</strong></p>
    <code>apt install certbot python-certbot-nginx</code>
    <p><strong>Requests certificate</strong></p>
    <code>certbot --nginx</code>
    <p>Follow the Certbot prompts.</p>
    <p><strong>Notes:</strong><em>Redirecting HTTP traffic to HTTPS is recommended.</em></p>
{% endblock %}
